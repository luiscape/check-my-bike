cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/year/'  # base url
for (i in 1:length(year)) {
m = paste("Appeal for year:", year[i], " | ")
cat(m)
query_url = paste0(url, year[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) it <- out
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
}
return(out)
}
x <- ftsAppealSummary(2015)
View(x)
it <- fromJSON(getURL(query_url))
View(it)
class(it)
# Function to fetch all transaction data
# from FTS using appeal IDs.
ftsAppealSummary <- function(id = NULL, year = NULL) {
# checking for parameters
if (is.null(id) & is.null(year)) {
stop('Please provide an emergency id or year. See documentation for more details. ?fetchEmergencyData')
}
if (!is.null(id) & !is.null(year)) {
stop('Provide either an emergency id OR a year. See documentation for more details. ?fetchEmergencyData')
}
## For emergency ids.
if (!is.null(id)) {
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/id/'  # base url
for (i in 1:length(id)) {
m = paste("Appeal summary:", id[i], " | ")
cat(m)
query_url = paste0(url, id[i], ".json")
doc <- fromJSON(getURL(query_url))
it <- as.data.frame(doc)
if (i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
}
## For years.
if (!is.null(year)) {
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/year/'  # base url
for (i in 1:length(year)) {
m = paste("Appeal for year:", year[i], " | ")
cat(m)
query_url = paste0(url, year[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
}
return(out)
}
View(x)
it <- fromJSON(getURL(query_url))
x <- ftsAppealSummary(2015)
View(x)
# Function to fetch all transaction data
# from FTS using appeal IDs.
ftsAppealSummary <- function(id = NULL, year = NULL) {
# checking for parameters
if (is.null(id) & is.null(year)) {
stop('Please provide an emergency id or year. See documentation for more details. ?fetchEmergencyData')
}
if (!is.null(id) & !is.null(year)) {
stop('Provide either an emergency id OR a year. See documentation for more details. ?fetchEmergencyData')
}
## For emergency ids.
if (!is.null(id)) {
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/id/'  # base url
for (i in 1:length(id)) {
m = paste("Appeal summary:", id[i], " | ")
cat(m)
query_url = paste0(url, id[i], ".json")
doc <- fromJSON(getURL(query_url))
it <- as.data.frame(doc)
if (i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
}
## For years.
if (!is.null(year)) {
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/year/'  # base url
for (i in 1:length(year)) {
m = paste("Appeal for year:", year[i], " | ")
cat(m)
query_url = paste0(url, year[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
}
return(out)
}
x <- ftsAppealSummary(year = 2015)
View(x)
x <- ftsAppealSummary(year = c(2000:2014))
View(x)
x <- ftsAppealSummary(c(1090, 1079))
View(x)
# Function to fetch record-by-record of each
# appeal in FTS.
ftsAppealTransactions <- function(id = NULL) {
# checking for parameters
if (is.null(id)) {
stop('Please provide an emergency id or year. See documentation for more details. ?fetchEmergencyData')
}
## For emergency ids.
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/id/'  # base url
for (i in 1:length(id)) {
m = paste("Appeal summary:", id[i], " | ")
cat(m)
query_url = paste0(url, id[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
return(out)
}
names(x)
y <- fetchAppealTransactions(x$id)
# Function to fetch record-by-record of each
# appeal in FTS.
ftsAppealTransactions <- function(id = NULL) {
# checking for parameters
if (is.null(id)) {
stop('Please provide an emergency id or year. See documentation for more details. ?fetchEmergencyData')
}
## For emergency ids.
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Appeal/id/'  # base url
for (i in 1:length(id)) {
m = paste("Appeal summary:", id[i], " | ")
cat(m)
query_url = paste0(url, id[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
return(out)
}
y <- fetchAppealTransactions(x$id)
y <- ftsAppealTransactions(x$id)
x <- ftsAppealSummary(year = 2015)
View(x)
y <- ftsAppealTransactions(x$id)
View(y)
# Function to fetch record-by-record of each
# appeal in FTS.
ftsAppealTransactions <- function(id = NULL) {
# checking for parameters
if (is.null(id)) {
stop('Please provide an emergency id or year. See documentation for more details. ?fetchEmergencyData')
}
## For emergency ids.
cat("--------------------------------\n")
url = 'http://fts.unocha.org/api/v1/Contribution/appeal/'  # base url
for (i in 1:length(id)) {
m = paste("Appeal summary:", id[i], " | ")
cat(m)
query_url = paste0(url, id[i], ".json")
it <- fromJSON(getURL(query_url))
if(i == 1) out <- it
else out <- rbind(out, it)
cat("done!\n")
}
cat("--------------------------------\n")
return(out)
}
y <- ftsAppealTransactions(x$id)
View(y)
data(mtcars)
attach(mtcars)
View(mtcars)
fit <- lm(mpg ~ factor(cyl) + wt); fit
factor(cyl)
unique(factor(cyl)))
unique(factor(cyl))
summary(fit)
qplot(wt, mpg, data=mtcars, colour=factor(cyl))
library(ggplot2)
qplot(wt, mpg, data=mtcars, colour=factor(cyl))
fit <- lm(mpg ~ factor(cyl) + wt); fit
data(mtcars)
attach(mtcars)
fit <- lm(mpg ~ factor(cyl) + wt); fit
summary(fit)
fit <- lm(mpg ~ factor(cyl)); fit
fit <- lm(mpg ~ as.factor(cyl) + wt); fit
summary(fit)
fit <- lm(mpg ~ factor(cyl) + wt); fit
summary(fit)
fit$coefficients
unique(factor(cyl))
length(unique(factor(cyl)))
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit <- lm(mpg ~ factor(cyl) + wt); fit
summary(fit)
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit2 <- lm(mpg ~ factor(cyl) + wt); fit2
summary(fit2)
27.9199 - 33.9908
fit$coefficients
fit$coefficients[1]
fit$coefficients[1] - fit$coefficients[3]
fit$coefficients[3] - fit$coefficients[1]
fit <- lm(mpg ~ factor(cyl) + wt); fit
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit2 <- lm(mpg ~ factor(cyl) + 0); fit2
summary(fit2)
26.6636 - 19.7429
33 - 29
29 - 27
fit <- lm(mpg ~ factor(cyl) + wt + cyl:wt + 0)
fit2 <- lm(mpg ~ factor(cyl) + wt + cyl:wt + 0); fit2
fit2 <- lm(mpg ~ factor(cyl) + wt + cyl*wt + 0); fit2
fit2 <- lm(mpg ~ factor(cyl) + wt + cyl:wt + 0); fit2
summary(fit2)
anova(fit, fit2)
a <- anova(fit, fit2); summary(a)
a <- anova(fit, fit2); summary(a); a
a <- anova(fit, fit2); summary(a); a
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit2 <- lm(mpg ~ factor(cyl) + wt + cyl:wt + 0); fit2
summary(fit2)
a <- anova(fit, fit2); summary(a); a
?I
data(mtcars)
attach(mtcars)
fit <- lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
summary(fit)
# question 4
data(mtcars)
attach(mtcars)
fit <- lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
summary(fit)
?mtcars
fit <- lm(mpg ~ I(wt * 0.5) + factor(cyl) + 0, data = mtcars)
summary(fit)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
?hatvalues
fit <- lm(y ~ x)
hatvalues(fit)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit <- lm(y ~ x)
?dfbeta
dfbeta(fit)
hatvalues(fit)
hatvalues(fit)
hatvalues(fit, 5)
hatvalues(fit)
?dfbeta
# question 6
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit <- lm(y ~ x)
dfbeta(fit)
# question 6
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit <- lm(y ~ x)
dfbetas(fit)
dfbeta(fit)
influence.measures(fit)
?influence.measures
# question 2
data(mtcars)
attach(mtcars)
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit2 <- lm(mpg ~ factor(cyl) + 0); fit2
summary(fit2)
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
fit2 <- lm(mpg ~ factor(cyl) + 0); fit2
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
# question 3
data(mtcars)
attach(mtcars)
fit <- lm(mpg ~ factor(cyl) + wt + 0); fit
summary(fit)
fit2 <- lm(mpg ~ factor(cyl) + wt + cyl:wt + 0); fit2
summary(fit2)
a <- anova(fit, fit2); summary(a); a
library(swirl)
swirld()
swirl()
33/36
deck
1/52
52
4/52
13/52
info
info()
4
5/52
1/52
(12/52)*(11/52)*(10/52)*(9/52)
(12/51)*(11/50)*(10/49)*(9/48)
(12/51)*(11/50)*(10/49)*(9/48)*1
(12/51)*(11/50)*(10/49)*(9/48)*1
info()
skip()
4
(3*4)/52
2/51
install.packages(c("data.table", "RCurl"))
install.packages("Rcpp")
library("acepack", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
detach("package:acepack", unload=TRUE)
library(dplur)
library(dplyr)
summarise()
2 + 2
a = 2 +2
b = 1
b + a
setwd("~/Documents/Programming/check-my-bike")
library(ggplot2)
source('scripts/R/helper/read_table.R')
data <- ReadTable('station_processed')
source('scripts/R/helper/read_table.R')
data <- ReadTable('station_processed')
data <- ReadTable('station_processed', deploy=FALSE)
source('scripts/R/helper/read_table.R')
data <- ReadTable('station_processed', deploy=FALSE)
source('scripts/R/helper/read_table.R')
data <- ReadTable('station_processed', deploy=FALSE)
ggplot(filter(data, availableBikesRatio > 0)) +
geom_bar(aes(availableBikesRatio), stat='bin') +
facet_wrap(~ executionTime)
library(dplyr)
library(sqldf)
library(lubridate)
source('scripts/R/helper/read_table.R')
source('scripts/R/helper/write_table.R')
#
# Prepare data for modeling.
#
CleanData <- function(df=NULL) {
#
# Select variables of interest.
#
s = select(df, id, availableDocks, totalDocks, statusValue, availableBikes, lastCommunicationTime, executionTime)
#
# Transforming numeric types.
#
s$totalDocks <- as.numeric(s$totalDocks)
s$availableDocks <- as.numeric(s$availableDocks)
s$availableBikes <- as.numeric(s$availableBikes)
#
# Transforming time.
#
s$executionTime <- as.POSIXct(s$executionTime)
s$lastCommunicationTime <- as.POSIXct(s$lastCommunicationTime)
s$week <- week(s$executionTime)
s$weekDay <- wday(s$executionTime)
#
# Adding ratios.
#
s$availableDocksRatio <- s$availableDocks / s$totalDocks
s$availableBikesRatio <- s$availableBikes / s$totalDocks
s$availabilityRatio <- s$availableDocksRatio + s$availableBikesRatio
s$usageRatio <- 1 - (s$availableDocksRatio + s$availableBikesRatio)
return(s)
}
#
# Wrapper.
#
Main <- function() {
#
# Load.
#
data <- ReadTable('station')
#
# Process.
#
processed_data <- CleanData(data)
#
# Store.
#
WriteTable(processed_data, 'station_processed', overwrite=TRUE)
}
Main()
data <- ReadTable('station', deploy=FALSE)
#
# Wrapper.
#
Main <- function() {
#
# Load.
#
data <- ReadTable('station', deploy=FALSE)
#
# Process.
#
processed_data <- CleanData(data)
#
# Store.
#
WriteTable(processed_data, 'station_processed', overwrite=TRUE)
}
Main()
source('scripts/R/helper/read_table.R')
data <- ReadTable('station_processed', deploy=FALSE)
ggplot(filter(data, availableBikesRatio > 0)) +
geom_bar(aes(availableBikesRatio), stat='bin') +
facet_wrap(~ executionTime)
names(data)
station_id = 445
filtered_data <- filter(data, id=station_id)
filtered_data <- filter(data, id == station_id)
nrow(filtered_data)
names(filtered_data)
filtered_data <- filter(data, id == station_id)
ggplot(filtered_data) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity')
View(filtered_data)
x <- filtered_data$executionTime[1]
x
as.POSIXct(x)
as.POSIXct(x, origin='1970-01-01')
filtered_data$executionTime <- as.POSIXct(filtered_data$executionTime, origin='1970-01-01')
ggplot(filtered_data) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity')
ggplot(filtered_data) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.5)
ggplot(filtered_data) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
filtered_data$executionTime <- as.POSIXct(filtered_data$executionTime, origin='1970-01-01')
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=1.3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity') +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=10) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=4) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=2) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), fill='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), color='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), fill='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikesRatio), color='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableBikesRatio), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikesRatio), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableBikes), color='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableBikes), stat='identity', size=3) +
geom_line(aes(executionTime, availableBikes), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableDocks), color='#FFFFFF', stat='identity', size=1.4) +
geom_point(aes(executionTime, availableDocks), stat='identity', size=3) +
geom_line(aes(executionTime, availableDocks), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableDocks), stat='identity', size=3) +
geom_line(aes(executionTime, availableDocks), stat='identity', size=1.3)
ggplot(filtered_data) +
geom_point(aes(executionTime, availableDocks), stat='identity', size=3) +
geom_bar(aes(executionTime, availableDocks), stat='identity', size=1.3)
ggplot(filtered_data) +
#geom_point(aes(executionTime, availableDocks), stat='identity', size=3) +
geom_bar(aes(executionTime, availableDocks), stat='identity', size=1.3)
ggplot(filtered_data) +
#geom_point(aes(executionTime, availableDocks), stat='identity', size=3) +
geom_bar(aes(executionTime, availableDocks), stat='identity')
